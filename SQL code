--Phase 1: Inspect Data

SELECT contact, COUNT(contact) FROM (select job FROM dbo.bankmkt WHERE job = 'admin.')
GROUP BY contact

SELECT poutcome,count(poutcome) FROM dbo.bankmkt
GROUP BY poutcome

SELECT deposit,count(deposit) FROM dbo.bankmkt
GROUP BY deposit

SELECT previous,count(previous)FROM bankmkt GROUP BY previous order BY previous desc

--Phase 2: Clean Data
--1. Remove unneeded "." in job column 
	
UPDATE bankmkt
set job = replace(job,'.','') from bankmkt;

--2. Join day and month into 1 column called ContactedDate and converted to date format

ALTER TABLE bankmkt
ADD ContactedDate Varchar(50)

UPDATE bankmkt 
SET ContactedDate = concat('2020','-',month,'-',day) from bankmkt

UPDATE bankmkt
SET ContactedDate = try_convert(date,ContactedDate) from bankmkt

--Remove unneeded column: 
ALTER TABLE bankmkt
DROP COLUMN day,month,pdays
 
--4. Add random order id into dataset
ALTER TABLE bankmkt
ADD ID INT

UPDATE bankmkt
SET ID = abs(checksum(NewId()) % 10000)
WHERE ID IS NULL
SELECT count(ID) FROM bankmkt

-- Rename and change column by using  Object Explorer

-- Phase 3:Analytic questions.

select * from bankmkt

-- check correlation between previous campaign and this campaign 
